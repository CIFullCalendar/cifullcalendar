/*!
 * CIFullCalendar v2.6.1
 * Docs & License: http://sirdre.com/apps/cifullcalendar/docs/
 * (c) 2015 sirdre
 */
!function(e){"use strict";if("function"==typeof define&&define.amd)define(["jquery","MarkerClusterer"],e);else if("object"==typeof exports)e(require("jquery"),require("google.maps.Geocoder"));else{if("undefined"==typeof google.maps.Geocoder)throw"CIFullCalendar requires Gmaps to be loaded first";if("undefined"==typeof MarkerClusterer)throw"CIFullCalendar requires MarkerClusterer to be loaded first";if("undefined"==typeof jQuery)throw"CIFullCalendar requires jQuery to be loaded first";e(jQuery,MarkerClusterer)}}(function(e,r){function o(e){var o={mapTypeId:google.maps.MapTypeId.ROADMAP};s=new google.maps.Map(document.getElementById("gmapsCanvas2"),o);var n="gmaps/get_marker?category="+e,i=[],u=[],c="";a(n,function(e,o){if(!t(o)){for(var n=0;n<o.length;++n){c=o[n];var a=new google.maps.LatLng(parseFloat(c.markers_lat),parseFloat(c.markers_lng));i=new google.maps.Marker({map:s,icon:d+""+c.markers_logo,position:a,title:c.markers_name}),p.extend(i.position),i.addListener("click",function(e,r){return function(){l.setContent('<h4><a href="'+o[r].markers_url+'" target="_blank">'+o[r].markers_name+"</a></h4><p>"+o[r].markers_desc+"</p><p><b>"+o[r].markers_address+"</b><br/><i>"+o[r].markers_lat+" , "+o[r].markers_lng+" </i></p><p><b>"+o[r].username+"</b></p>"),l.open(s,this)}}(i,n)),u.push(i)}new r(s,u)}s.fitBounds(p),s.panToBounds(p)});var f={name:"gStyle"},g=[{featureType:"road",elementType:"all",stylers:[{visibility:"on"}]}],m=new google.maps.StyledMapType(g,f);s.mapTypes.set("gStyle",m),s.setMapTypeId("gStyle")}function t(e){var r=typeof e;return"undefined"===r||("object"===r?null===e||0===Object.keys(e).length:[!1,0,"","0"].indexOf(e)>=0)}function n(r){r.lengthComputable&&e("progress").attr({value:r.loaded,max:r.total})}function a(r,o){function t(){a()}function a(){4===d.readyState?(e("#loading").show(),n(4===d.readyState),(200===d.status||304===d.status||1223===d.status)&&o(d)):e("#loading").hide()}function s(){var e=void 0;if(d.response?e=d.response:"text"!==d.responseType&&d.responseType||(e=d.responseText||d.responseXML),u)try{e=JSON.parse(e)}catch(r){}return e}function i(e){clearTimeout(g),e instanceof Error||(e=new Error(""+(e||"Unknown Error"))),e.statusCode=0,o(e,m)}function l(e){var r=d.headers;if(!e)return r;for(var o=e.split("\r\n"),t=0;t<o.length;t++){var n=o[t],a=n.indexOf(": ");if(a>0){var s=n.substring(0,a);n.substring(a,2);if(!d.setRequestHeader)throw new Error("Headers cannot be set on object");for(s in r)r.hasOwnProperty(s)&&d.setRequestHeader(s,r[s])}}return r}function p(){if(!f){var e;clearTimeout(g),e=void 0===d.status?200:1223===d.status?204:d.status;var t=m,n=null;0!==e?(t={body:s(),statusCode:e,method:y,headers:{},url:r,rawRequest:d},d.getAllResponseHeaders&&(t.headers=l(d.getAllResponseHeaders()))):n=new Error("Internal Error"),o(n,t.body)}}var d,u=!0;if("undefined"==typeof o)try{d=new XMLHttpRequest}catch(c){throw new Error("argument missing")}(window.XMLHttpRequest||window.document||window.ActiveXObject)&&(d=new XMLHttpRequest);var f,g,m={body:void 0,headers:{},statusCode:0,method:y,url:r,rawRequest:d},y=d.method="GET",w=s(),h=d.headers,v=0;return u&&"GET"!==y&&"HEAD"!==y&&(h["content-type"]||h["Content-Type"]||(h["Content-Type"]="application/json")||(h["Access-Control-Allow-Methods"]="GET")||(h["Access-Control-Allow-Origin"]="*"),w=JSON.stringify()),d.onreadystatechange=t,d.onload=p,d.onerror=i,d.onprogress=a,d.ontimeout=i,d.open(y,r,!0),v>0&&(g=setTimeout(function(){f=!0,d.abort("timeout");var e=new Error("timeout");e.code="ETIMEDOUT",i(e)},v)),d.send(w),d}var s,i=new RegExp("index.php/calendar/gmaps|calendar/gmaps"),l=(new google.maps.Geocoder,new google.maps.InfoWindow),p=new google.maps.LatLngBounds,d=window.location.protocol+"//"+window.location.host+"/"+window.location.pathname.replace(i,"")+"assets/img/pin/";window.location.protocol+"//"+window.location.host+window.location.pathname.replace("calendar/gmaps","")+"calendar";o(),e("#marker_category").change(function(){var r=e("#marker_category option:selected").val();o(r)}),a("home/get_category",function(r,o){if(!t(o))for(var n=0;n<o.length;n++)e("#marker_category").append("<option value="+o[n].category_id+">"+o[n].category_name+" ("+o[n].count+")</option>")})});